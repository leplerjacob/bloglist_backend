(this.webpackJsonpbloglist_frontend=this.webpackJsonpbloglist_frontend||[]).push([[0],{140:function(e,t,n){},141:function(e,t,n){},452:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n(2),s=n.n(r),a=n(18),u=n.n(a),i=(n(140),n(77)),o=n(6),l=(n(141),n(19)),b=n.n(l),d=n(34),j=n(29),f=n.n(j),h="/api/blogs",O={getAll:function(){return f.a.get(h).then((function(e){return e.data}))},createBlog:function(){var e=Object(d.a)(b.a.mark((function e(t,n){var c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=f.a.post(h,t,{headers:{Authorization:"bearer "+n.token}}),e.abrupt("return",c.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),setToken:function(e){"bearer ".concat(e)},updateBlogLikes:function(){var e=Object(d.a)(b.a.mark((function e(t,n){var c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=f.a.put(h+"/".concat(t.id),t.likedBlog,{headers:{Authorization:"bearer "+n.token}}),e.abrupt("return",c.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),deleteBlog:function(){var e=Object(d.a)(b.a.mark((function e(t,n){var c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=f.a.delete(h+"/".concat(t.id),{headers:{Authorization:"bearer "+n.token}}),e.abrupt("return",c.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},g=(n(158),function(e){var t=e.blog,n=e.addLike,s=e.deleteBlog,a=e.user,u=Object(r.useState)(!1),i=Object(o.a)(u,2),l=i[0],b=i[1],d={display:l?"":"none"},j=function(){n({id:t.id,likedBlog:{likes:t.likes+1}})},f=function(){window.confirm("Are you sure you want to delete this blog?")&&s(t)};return Object(c.jsxs)("div",{className:"card blog",children:[Object(c.jsx)("h2",{children:t.title}),Object(c.jsx)("button",{onClick:function(){b(!l)},children:l?"Hide":"Show"}),Object(c.jsxs)("div",{style:d,children:[Object(c.jsx)("h3",{children:t.author}),Object(c.jsxs)("p",{children:["URL: ",t.url]}),Object(c.jsxs)("p",{children:["Likes: ",t.likes]}),a?Object(c.jsx)("button",{onClick:j,children:"Like"}):void 0,function(){if(a)return a.username===t.user.username?Object(c.jsx)("button",{onClick:f,title:"Delete blog",children:"Delete"}):Object(c.jsx)("button",{disabled:"disabled",title:"Only blog creator may delete",children:"Delete"})}()]})]})}),p={login:function(){var e=Object(d.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},v=function(e){var t=e.props,n=t.success,r=t.message;return Object(c.jsx)("div",{children:n?Object(c.jsx)("h2",{className:"notify success",children:r}):Object(c.jsx)("h2",{className:"notify failed",children:r})})},x=s.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),s=Object(o.a)(n,2),a=s[0],u=s[1],i={display:a?"none":""},l={display:a?"":"none"},b=function(){u(!a)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:b}})),Object(c.jsxs)("div",{children:[Object(c.jsx)("div",{style:i,children:Object(c.jsx)("button",{onClick:b,children:e.buttonLabel})}),Object(c.jsxs)("div",{style:l,children:[e.children,Object(c.jsx)("button",{onClick:b,children:"cancel"})]})]})})),m=function(e){var t=e.handleSubmit,n=Object(r.useState)(""),s=Object(o.a)(n,2),a=s[0],u=s[1],i=Object(r.useState)(""),l=Object(o.a)(i,2),b=l[0],d=l[1];return Object(c.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({username:a,password:b})},children:[Object(c.jsx)("h2",{children:"Login"}),Object(c.jsxs)("div",{children:["username",Object(c.jsx)("input",{type:"text",value:a,name:"Username",onChange:function(e){var t=e.target;return u(t.value)}})]}),Object(c.jsxs)("div",{children:["password",Object(c.jsx)("input",{type:"password",value:b,name:"Password",onChange:function(e){var t=e.target;return d(t.value)}})]}),Object(c.jsx)("button",{type:"submit",children:"login"})]})},k=function(e){var t=e.createBlog,n=e.user,s=Object(r.useState)(""),a=Object(o.a)(s,2),u=a[0],i=a[1],l=Object(r.useState)(""),b=Object(o.a)(l,2),d=b[0],j=b[1],f=Object(r.useState)(""),h=Object(o.a)(f,2),O=h[0],g=h[1],p=Object(r.useState)(""),v=Object(o.a)(p,2),x=v[0],m=v[1];return Object(c.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({title:u,author:O,url:d,likes:x},n),i(""),j(""),g(""),m("")},children:["title:",Object(c.jsx)("input",{type:"text",value:u,onChange:function(e){var t=e.target;return i(t.value)}}),"author:",Object(c.jsx)("input",{type:"text",value:O,onChange:function(e){var t=e.target;return g(t.value)}}),"url:",Object(c.jsx)("input",{type:"text",value:d,onChange:function(e){var t=e.target;return j(t.value)}}),Object(c.jsx)("input",{type:"number",value:x,onChange:function(e){var t=e.target;return m(t.value)}}),Object(c.jsx)("button",{type:"submit",children:"Create Blog"})]})},y=function(){var e=Object(r.useState)([]),t=Object(o.a)(e,2),n=t[0],s=t[1],a=Object(r.useState)(null),u=Object(o.a)(a,2),l=u[0],b=u[1],d=Object(r.useState)(null),j=Object(o.a)(d,2),f=j[0],h=j[1],y=Object(r.useRef)(),w=Object(r.useRef)();Object(r.useEffect)((function(){O.getAll().then((function(e){s(e)})).catch((function(e){console.log(e)}))}),[]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedNoteappUser");if(e){var t=JSON.parse(e);b(t)}}),[]);var S=function(e){p.login(e).then((function(e){h({success:!0,message:"Login successful"}),window.localStorage.setItem("loggedBlogUser",JSON.stringify(e)),b(e),N()})).catch((function(e){h({success:!1,message:"Invalid Credentials"}),N()}))},B=function(e){w.current.toggleVisibility(),O.createBlog(e,l).then((function(e){e=Object(i.a)(Object(i.a)({},e),{},{user:{username:l.username,id:e.user}}),s(n.concat(e)),h({success:!0,message:'New blog "'.concat(e.title,'" by ').concat(e.author," has been added")}),N()})).catch((function(e){h({success:!1,message:"An error occurred submitting blog"}),N()}))},C=function(e){O.updateBlogLikes(e,l).then((function(e){h({success:!0,message:"".concat(l.name,' has liked the blog: "').concat(e.title,'"')}),N(),s(n.map((function(t){return t.id===e.id?e:t})))})).catch((function(e){h({success:!1,message:"Blog like not successful"}),N()}))},L=function(e){O.deleteBlog(e,l).then((function(e){h({success:!0,message:"Blog successfully deleted"}),N(),s(n.filter((function(t){return t.id!==e.id})))})).catch((function(e){console.log(e),h({success:!1,message:"Blog deletion unsuccessful"}),N()}))},N=function(){setTimeout((function(){h(null)}),5e3)};return Object(c.jsxs)("div",{children:[f&&Object(c.jsx)(v,{props:f}),Object(c.jsxs)("div",{className:"front",children:[null===l?Object(c.jsx)("div",{children:Object(c.jsx)(x,{buttonLabel:"Login",ref:y,children:Object(c.jsx)(m,{handleSubmit:S})})}):Object(c.jsx)("div",{children:Object(c.jsx)(x,{buttonLabel:"New Blog",ref:w,children:Object(c.jsx)(k,{createBlog:B,user:l})})}),Object(c.jsx)("div",{children:n.sort((function(e,t){return e.likes-t.likes})).map((function(e){return Object(c.jsx)(g,{user:l,blog:e,addLike:C,deleteBlog:L},e.id)}))})]})]})};u.a.render(Object(c.jsx)(y,{}),document.getElementById("root"))}},[[452,1,2]]]);
//# sourceMappingURL=main.db5dd217.chunk.js.map